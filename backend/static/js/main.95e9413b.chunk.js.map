{"version":3,"sources":["store/actions/actionTypes.js","store/Utility.js","store/reducers/reducer.js","store/actions/action.js","WebSocket.js","Component/Chat.js","routes.js","Component/Sidepanel.js","hoc/hoc.js","Component/Profile.js","App.js","index.js"],"names":["AUTH_START","AUTH_SUCCESS","AUTH_FAIL","AUTH_LOGOUT","updateObject","oldObject","updatedProperties","initialState","token","username","error","loading","authStart","state","action","console","log","authSuccess","authFail","authLogout","reducer","type","actionTypes","logout","localStorage","removeItem","checkAuthTimeout","expirationTime","dispatch","setTimeout","WebSocketService","callbacks","this","socketRef","instace","instance","WebSocket","onopen","socketNewMessage","JSON","stringify","command","onmessage","e","data","onclose","connect","onerror","message","parseData","parse","Object","keys","length","messages","sendMessage","from","content","messagesCallback","newMessageCallback","send","err","readyState","WebSocketInstance","getInstance","Chat","props","renderMessages","map","className","author","src","timestamp","substring","id","messageChangeHandler","setState","target","value","sendMessageHandler","preventDefault","messageObject","newChatMessage","waitForSocketConnection","addCallbacks","setMessage","bind","addMessage","fetchMessages","callback","component","reverse","onSubmit","onChange","placeholder","aria-hidden","React","Component","BaseRouter","exact","path","Sidepanel","loginForm","changeForm","isTrusted","authenticate","login","password","signup","email","password2","alt","LoadingOutlined","isAuthenticated","onClick","method","name","htmlFor","userName","axios","post","then","res","key","expirationDate","Date","getTime","setItem","catch","actions","password1","Hoc","children","Profile","App","onTryAutoSignup","getItem","undefined","store","createStore","composeWithDevTools","applyMiddleware","thunk","app","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.95e9413b.chunk.js","sourcesContent":["export const AUTH_START = 'AUTH_START';\r\nexport const AUTH_SUCCESS = 'AUTH_SUCCESS';\r\nexport const AUTH_FAIL = 'AUTH_FAIL';\r\nexport const AUTH_LOGOUT = 'AUTH_LOGOUT';","const updateObject = (oldObject, updatedProperties) => {\r\n    return {\r\n        ...oldObject,\r\n        ...updatedProperties\r\n    }\r\n}\r\n\r\nexport default updateObject","import * as actionTypes from  '../actions/actionTypes'\r\nimport  updateObject  from '../Utility'\r\n\r\n\r\n\r\nconst initialState = {\r\n    token: null,\r\n    username: null,\r\n    error: null, \r\n    loading: false\r\n}\r\n\r\nconst authStart = (state, action) => {\r\n    console.log('authStart')\r\n    return updateObject(state, {\r\n        error: null,\r\n        loading: true\r\n    });\r\n}\r\n\r\nconst authSuccess = (state, action) => {\r\n    console.log('authSucces')\r\n    return updateObject(state, {\r\n        token: action.token,\r\n        username: action.username,\r\n        error: null,\r\n        loading: false\r\n    });\r\n}\r\n\r\nconst authFail = (state, action) => {\r\n    return updateObject(state, {\r\n        error: action.error,\r\n        loading: false\r\n    });\r\n}\r\n\r\nconst authLogout = (state, action) => {\r\n    return updateObject(state, {\r\n        token: null,\r\n        username: null\r\n    });\r\n}\r\n\r\nconst reducer = (state=initialState, action) => {\r\n    switch (action.type) {\r\n        case actionTypes.AUTH_START: return authStart(state, action);\r\n        case actionTypes.AUTH_SUCCESS: return authSuccess(state, action);\r\n        case actionTypes.AUTH_FAIL: return authFail(state, action);\r\n        case actionTypes.AUTH_LOGOUT: return authLogout(state, action);\r\n        default:\r\n            return state;\r\n    }\r\n}\r\n\r\nexport default reducer;","import axios from 'axios';\r\nimport * as actionTypes from './actionTypes';\r\n\r\nexport const authStart = () => {\r\n    console.log('authStart in the action')\r\n    return {\r\n        type: actionTypes.AUTH_START\r\n    }\r\n}\r\n\r\nexport const authSuccess = (username, token) => {\r\n    console.log('token::',token)\r\n    return {\r\n        type: actionTypes.AUTH_SUCCESS,\r\n        token: token,\r\n        username: username\r\n    }\r\n}\r\n\r\nexport const authFail = error => {\r\n    return {\r\n        type: actionTypes.AUTH_FAIL,\r\n        error: error\r\n    }\r\n}\r\n\r\nexport const logout = () => {\r\n    localStorage.removeItem('token');\r\n    localStorage.removeItem('username');\r\n    localStorage.removeItem('expirationDate');\r\n    return {\r\n        type: actionTypes.AUTH_LOGOUT\r\n    };\r\n}\r\n\r\nexport const checkAuthTimeout = expirationTime => {\r\n    return dispatch => {\r\n        setTimeout(() => {\r\n            dispatch(logout());\r\n        }, expirationTime * 1000)\r\n    }\r\n}\r\n\r\nexport const authLogin = (username, password) => {\r\n    console.log('login')\r\n    return dispatch => {\r\n        dispatch(authStart());\r\n        axios.post('http://127.0.0.1:8000/rest-auth/login/', {\r\n            username: username,\r\n            password: password\r\n        })\r\n        .then(res => {\r\n            console.log('res::', res)\r\n            const token = res.data.key;\r\n            const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\r\n            console.log('token1::', token)\r\n            localStorage.setItem('token', token);\r\n            localStorage.setItem('username', username);\r\n            localStorage.setItem('expirationDate', expirationDate);\r\n            dispatch(authSuccess(username, token));\r\n            dispatch(checkAuthTimeout(3600));\r\n        })\r\n        .catch(err => {\r\n            dispatch(authFail(err))\r\n        })\r\n    }\r\n}\r\n\r\n// export const authLogin = (username, password) => {\r\n//     console.log('login')\r\n//     return dispatch => {\r\n//         dispatch(authStart());\r\n//         axios({method:'post', url:'http://127.0.0.1:8000/rest-auth/login/', data:{\r\n//             username: username,\r\n//             password: password\r\n//         }})\r\n//         .then(res => {\r\n//             console.log('res::', res)\r\n//             const token = res.data.key;\r\n//             const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\r\n//             console.log('token1::', token)\r\n//             localStorage.setItem('token', token);\r\n//             localStorage.setItem('username', username);\r\n//             localStorage.setItem('expirationDate', expirationDate);\r\n//             dispatch(authSuccess(username, token));\r\n//             dispatch(checkAuthTimeout(3600));\r\n//         })\r\n//         .catch(err => {\r\n//             dispatch(authFail(err))\r\n//         })\r\n//     }\r\n//  }\r\n\r\nexport const authSignup = (username, email, password1, password2) => {\r\n    return dispatch => {\r\n        dispatch(authStart());\r\n        axios.post('http://127.0.0.1:8000/rest-auth/registration/', {\r\n            username: username,\r\n            email: email,\r\n            password1: password1,\r\n            password2: password2\r\n        })\r\n        .then(res => {\r\n            const token = res.data.key;\r\n            const expirationDate = new Date(new Date().getTime() + 3600 * 1000);\r\n            localStorage.setItem('token', token);\r\n            localStorage.setItem('username', username);\r\n            localStorage.setItem('expirationDate', expirationDate);\r\n            dispatch(authSuccess(username, token));\r\n            dispatch(checkAuthTimeout(3600));\r\n        })\r\n        .catch(err => {\r\n            dispatch(authFail(err))\r\n        })\r\n    }\r\n}\r\n\r\nexport const authCheckState = () => {\r\n    return dispatch => {\r\n        const token = localStorage.getItem('token');\r\n        const username = localStorage.getItem('username');\r\n        if (token === undefined) {\r\n            dispatch(logout());\r\n        } else {\r\n            const expirationDate = new Date(localStorage.getItem('expirationDate'));\r\n            if ( expirationDate <= new Date() ) {\r\n                dispatch(logout());\r\n            } else {\r\n                dispatch(authSuccess(username, token));\r\n                dispatch(checkAuthTimeout( (expirationDate.getTime() - new Date().getTime()) / 1000) );\r\n            }\r\n        }\r\n    }\r\n}","class WebSocketService {\r\n    // static is method or instance in the class\r\n    static instance = null;\r\n    // put sth later\r\n    callbacks = {};\r\n    static getInstance() {\r\n        if (!WebSocketService.instace) {\r\n            WebSocketService.instance = new WebSocketService()\r\n        }\r\n        return WebSocketService.instance\r\n    }\r\n\r\n    constructor() {\r\n        this.socketRef = null;\r\n\r\n    }\r\n    connect() {\r\n        const path = 'ws://127.0.0.1:8000/ws/chat/test/'\r\n        this.socketRef = new WebSocket(path)\r\n        this.socketRef.onopen = () => {\r\n            console.log('open')\r\n        }\r\n        this.socketNewMessage(JSON.stringify({\r\n            // fetch_messages => messages\r\n            command: 'messages'\r\n        }))\r\n        this.socketRef.onmessage = e => {\r\n            this.socketNewMessage(e.data)\r\n        }\r\n        this.socketRef.onclose = () => {\r\n            console.log('close')\r\n            this.connect()\r\n        }\r\n        this.socketRef.onerror = e => {\r\n            console.log(e.message)\r\n        }\r\n    }\r\n\r\n    socketNewMessage(data) {\r\n        const parseData = JSON.parse(data)\r\n        const command = parseData.command\r\n        console.log('parseData::',parseData)\r\n        if (Object.keys(this.callbacks).length === 0) {\r\n            return \r\n        }\r\n        if (command === 'messages') {\r\n            // as you can seee addCallback, callbacks[command] is function. so you put Parsedata.message(s) in messagesCallback or newMessageCallback\r\n            this.callbacks[command](parseData.messages)\r\n        }\r\n        if (command === 'new_message') {\r\n            this.callbacks[command](parseData.message)\r\n        }\r\n    }\r\n\r\n    fetchMessages(username) {\r\n        this.sendMessage({command: 'fetch_messages', username: username})\r\n    }\r\n    \r\n    newChatMessage(message) {\r\n        console.log('newChatMessage::', message)\r\n        this.sendMessage({command: 'new_message',from: message.from, message: message.content})\r\n    }\r\n\r\n    addCallbacks(messagesCallback, newMessageCallback) {\r\n        this.callbacks['messages'] = messagesCallback;\r\n        this.callbacks['new_message'] = newMessageCallback\r\n    }\r\n\r\n    sendMessage(data) {\r\n        console.log('data in sendMessage',data)\r\n        try {\r\n            this.socketRef.send(JSON.stringify({...data }))\r\n        } catch (err) {\r\n            console.log(err.message)\r\n        } \r\n    }\r\n\r\nstate() {\r\n    return this.socketRef.readyState\r\n}\r\n\r\n}\r\n\r\n// WebSocketInstance is new instance \r\nconst WebSocketInstance = WebSocketService.getInstance()\r\n\r\nexport default WebSocketInstance;","import React from 'react'\r\nimport WebSocketInstance from '../WebSocket.js'\r\nimport '../index.css'\r\nclass Chat extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\t\tthis.state = {\r\n\t\t\tmessages: [],\r\n\t\t\tmessage: ''\r\n\r\n\t\t}\r\n\t\tthis.waitForSocketConnection(() => {\r\n\t\t\tWebSocketInstance.addCallbacks(\r\n\t\t\t\tthis.setMessage.bind(this),\r\n\t\t\t\tthis.addMessage.bind(this))\r\n\t\t\t\t//this.props.currentUser => daisuke\r\n\t\t\tWebSocketInstance.fetchMessages('daisuke')\r\n\t\t})\r\n\t}\r\n\twaitForSocketConnection(callback) {\r\n\t\tconst component = this // this is Chat\r\n        // const socket = this.socketRef\r\n        //const recursion = .waitForSocketConnection\r\n        setTimeout(\r\n            function() {\r\n                if (WebSocketInstance.state() === 1) {\r\n                    console.log('connection is secure')\r\n                    callback()\r\n                    return;\r\n                } else {\r\n                    console.log('waiting for connection ....')\r\n                    component.waitForSocketConnection(callback)\r\n                } \r\n            }, 100);\r\n\t}\r\n\r\n\tsetMessage(messages) {\r\n\t\t//messages.reverse() => messages\r\n\t\tthis.setState({messages: messages.reverse()})\r\n\t}\r\n\t\r\n\taddMessage(message) {\r\n\t\t// ... means *args\r\n\t\tthis.setState({messages: [...this.state.messages, message[0]]})\r\n\t}\r\n\r\n\trenderMessages = (messages) => {\r\n\t\tconst currentUser = 'kikuchi'\r\n\t\treturn messages.map(message => (\r\n\t\t\t<li\r\n\t\t\tkey={message.id}\r\n\t\t\tclassName={message.author === currentUser ? 'sent': 'replies'}>\r\n\t\t\t<img src='http://emilcarlsson.se/assets/mikeross.png'/>\r\n\t\t\t<p>\r\n\t\t\t\t{message.content}\r\n\t\t\t\t<br/>\r\n\t\t\t\t<small>\r\n\t\t\t\t\t{message.timestamp.substring(0,16)}\r\n\t\t\t\t\t{/*{Math.round(new Date().getTime() - new Date(message.timestamp).getTime()/60000)} minutes ago*/}\r\n\t\t\t\t</small>\r\n\t\t\t</p>\r\n\t\t\t</li>\r\n\t\t))\r\n\t}\r\n\t\r\n\tmessageChangeHandler = e => {\r\n\t\tthis.setState({message: e.target.value})\r\n\t}\r\n\r\n\tsendMessageHandler = e =>{\r\n\t\te.preventDefault();\r\n\t\tconst messageObject = {\r\n\t\t\tfrom: 'kikuchi',\r\n\t\t\tcontent: this.state.message\r\n\t\t}\r\n\t\tif (messageObject.content) {\r\n\t\t\tconsole.log(messageObject.content)\r\n\t\t\tWebSocketInstance.newChatMessage(messageObject);\r\n\t\t    this.setState({\r\n\t\t\t     message: ''\r\n\t\t})\r\n\t}}\r\n\r\n    render() {\r\n\t\tconst messages = this.state.messages;\r\n        return (\r\n    <div id=\"frame\">\r\n\t\t<div className=\"messages\">\r\n\t\t\t<ul id='chat-log'>\r\n\t\t\t\t{messages && this.renderMessages(messages)}\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t\t<div className=\"message-input\">\r\n\t\t\t<form onSubmit={this.sendMessageHandler}>\r\n\t\t\t<div className=\"wrap\">\r\n\t\t\t<input onChange={this.messageChangeHandler}\r\n\t\t\tvalue={this.state.message}id=\"chat-message-input\" type=\"text\" placeholder=\"Write your message...\" />\r\n\t\t\t<i className=\"fa fa-paperclip attachment\" aria-hidden=\"true\"></i>\r\n\t\t\t<button id=\"chat-message-submit\" className=\"submit\">\r\n\t\t\t\t<i className=\"fa fa-paper-plane\" aria-hidden=\"true\"></i>\r\n\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t</div>\r\n        )\r\n\r\n  }\r\n  }\r\n  \r\n  export default Chat;","import React from \"react\";\r\nimport { Route } from \"react-router-dom\";\r\n\r\nimport Chat from \"./Component/Chat\";\r\n\r\nconst BaseRouter = () => (\r\n  <div>\r\n    <Route exact path=\"/:chatID/\" component={Chat} />\r\n  </div>\r\n);\r\n\r\nexport default BaseRouter;","import React from 'react';\r\nimport { LoadingOutlined } from '@ant-design/icons'\r\nimport { connect } from 'react-redux';\r\nimport * as actions from '../store/actions/action';\r\nimport '../index.css'\r\n\r\n\r\n\r\nclass Sidepanel extends React.Component {\r\n\r\n    state = { \r\n        loginForm: true,\r\n    }\r\n\r\n    changeForm = (e) => {\r\n        if (e.isTrusted) {\r\n            this.setState({ loginForm: !this.state.loginForm });\r\n        }\r\n    }\r\n\r\n    authenticate = (e) => {\r\n        e.preventDefault();\r\n        if (this.state.loginForm) {\r\n            this.props.login(\r\n                e.target.username.value, \r\n                e.target.password.value\r\n            );\r\n        } else {\r\n            this.props.signup(\r\n                e.target.username.value, \r\n                e.target.email.value, \r\n                e.target.password.value, \r\n                e.target.password2.value\r\n            );\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div id=\"sidepanel\">\r\n            <div id=\"profile\">\r\n                <div className=\"wrap\">\r\n                <img id=\"profile-img\" src=\"http://emilcarlsson.se/assets/mikeross.png\" className=\"online\" alt=\"\" />\r\n                <p>Mike Ross</p>\r\n                <i className=\"fa fa-chevron-down expand-button\" aria-hidden=\"true\"></i>\r\n                <div id=\"status-options\">\r\n                    <ul>\r\n                    <li id=\"status-online\" className=\"active\"><span className=\"status-circle\"></span> <p>Online</p></li>\r\n                    <li id=\"status-away\"><span className=\"status-circle\"></span> <p>Away</p></li>\r\n                    <li id=\"status-busy\"><span className=\"status-circle\"></span> <p>Busy</p></li>\r\n                    <li id=\"status-offline\"><span className=\"status-circle\"></span> <p>Offline</p></li>\r\n                    </ul>\r\n                </div>\r\n                <div id=\"expanded\">\r\n                    {\r\n                        this.props.loading ?\r\n\r\n                        <LoadingOutlined />:\r\n\r\n                        this.props.isAuthenticated ? \r\n                    \r\n                        <button onClick={() => this.props.logout()} className=\"authBtn\"><span>Logout</span></button>\r\n                        \r\n                        :\r\n                        \r\n                        <div>\r\n                            <form method=\"POST\" onSubmit={this.authenticate}>\r\n                                \r\n                                {\r\n                                    this.state.loginForm ?\r\n\r\n                                    <div>\r\n                                        <input name=\"username\" type=\"text\" placeholder=\"username\" />\r\n                                        <input name=\"password\" type=\"password\" placeholder=\"password\" />\r\n                                    </div>\r\n\r\n                                    :\r\n\r\n                                    <div>\r\n                                        <input name=\"username\" type=\"text\" placeholder=\"username\" />\r\n                                        <input name=\"email\" type=\"email\" placeholder=\"email\" />\r\n                                        <input name=\"password\" type=\"password\" placeholder=\"password\" />\r\n                                        <input name=\"password2\" type=\"password\" placeholder=\"password confirm\" />\r\n                                    </div>\r\n                                }\r\n                                \r\n                                <button type=\"submit\">Authenticate</button>\r\n\r\n                            </form>\r\n\r\n                            <button onClick={this.changeForm}>Switch</button>\r\n                        </div>\r\n                    }\r\n                </div>\r\n                </div>\r\n            </div>\r\n            <div id=\"search\">\r\n                <label htmlFor=\"\"><i className=\"fa fa-search\" aria-hidden=\"true\"></i></label>\r\n                <input type=\"text\" placeholder=\"Search contacts...\" />\r\n            </div>\r\n            <div id=\"contacts\">\r\n                <ul>\r\n                <li className=\"contact\">\r\n                    <div className=\"wrap\">\r\n                    <span className=\"contact-status online\"></span>\r\n                    <img src=\"http://emilcarlsson.se/assets/louislitt.png\" alt=\"\" />\r\n                    <div className=\"meta\">\r\n                        <p className=\"name\">Louis Litt</p>\r\n                        <p className=\"preview\">You just got LITT up, Mike.</p>\r\n                    </div>\r\n                    </div>\r\n                </li>\r\n                <li className=\"contact active\">\r\n                    <div className=\"wrap\">\r\n                    <span className=\"contact-status busy\"></span>\r\n                    <img src=\"http://emilcarlsson.se/assets/harveyspecter.png\" alt=\"\" />\r\n                    <div className=\"meta\">\r\n                        <p className=\"name\">Harvey Specter</p>\r\n                        <p className=\"preview\">Wrong. You take the gun, or you pull out a bigger one. Or, you call their bluff. Or, you do any one of a hundred and htmlForty six other things.</p>\r\n                    </div>\r\n                    </div>\r\n                </li>\r\n                </ul>\r\n            </div>\r\n            <div id=\"bottom-bar\">\r\n                <button id=\"addcontact\"><i className=\"fa fa-user-plus fa-fw\" aria-hidden=\"true\"></i> <span>Add contact</span></button>\r\n                <button id=\"settings\"><i className=\"fa fa-cog fa-fw\" aria-hidden=\"true\"></i> <span>Settings</span></button>\r\n            </div>\r\n            </div>\r\n        );\r\n    };\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        isAuthenticated: state.token !== null,\r\n        loading: state.loading\r\n    }\r\n}\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        login: (userName, password) => dispatch(actions.authLogin(userName, password)),\r\n        logout: () => dispatch(actions.logout()),\r\n        signup: (username, email, password1, password2) => dispatch(actions.authSignup(username, email, password1, password2)),\r\n    }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Sidepanel);\r\n\r\n","const Hoc = (props) => (\r\n    props.children\r\n)\r\n\r\nexport default Hoc;","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport Hoc from '../hoc/hoc';\r\nimport '../index.css'\r\n\r\nclass Profile extends React.Component {\r\n    render() {\r\n        return (\r\n            <div className=\"contact-profile\">\r\n            {\r\n                this.props.username !== null ?\r\n\r\n                <Hoc>\r\n                    <img src=\"http://emilcarlsson.se/assets/harveyspecter.png\" alt=\"\" />\r\n                    <p>{this.props.username}</p>\r\n                    <div className=\"social-media\">\r\n                    <i className=\"fa fa-facebook\" aria-hidden=\"true\"></i>\r\n                    <i className=\"fa fa-twitter\" aria-hidden=\"true\"></i>\r\n                    <i className=\"fa fa-instagram\" aria-hidden=\"true\"></i>\r\n                    </div>\r\n                </Hoc>\r\n                \r\n                :\r\n\r\n                null\r\n            }\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n    return {\r\n        username: state.username\r\n    }\r\n}\r\n    \r\nexport default connect(mapStateToProps)(Profile);","import React from 'react';\nimport { connect } from 'react-redux';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport * as actions from './store/actions/action';\nimport BaseRouter from './routes';\nimport Sidepanel from './Component/Sidepanel';\nimport Profile from './Component/Profile';\n\n\n  class App extends React.Component {\n\n    componentDidMount() {\n        this.props.onTryAutoSignup();\n    }\n\n    // componentDidMount() {\n    //   WebSocketInstance.connect()\n    // }\n\n    render() {\n        return(\n            <Router>\n                <div id=\"frame\">\n                    <Sidepanel />\n                    <div className=\"content\">\n                        <Profile />\n                        <BaseRouter />\n                    </div>\n                </div>\n            </Router>\n        );\n    };\n}\n  \nconst mapDispatchToProps = dispatch => {\n    return {\n        onTryAutoSignup: () => dispatch(actions.authCheckState())\n    }\n}\n\nexport default connect(null, mapDispatchToProps)(App);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { createStore, compose, applyMiddleware } from 'redux';\nimport { Provider } from 'react-redux';\nimport 'antd/dist/antd.css';\nimport reducer from './store/reducers/reducer';\nimport App from './App';\nimport { composeWithDevTools } from \"redux-devtools-extension\";\nimport thunk from 'redux-thunk';\nconst store = createStore(reducer, composeWithDevTools(applyMiddleware(thunk)))\nconst app = (\n    <Provider store={store}>\n        <App />\n    </Provider>\n)\n\n\nReactDOM.render(app, document.getElementById(\"app\"));"],"sourceRoot":""}