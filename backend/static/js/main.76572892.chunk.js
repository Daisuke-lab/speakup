(this.webpackJsonpchatapp=this.webpackJsonpchatapp||[]).push([[0],{32:function(e,t,s){},81:function(e,t,s){},84:function(e,t,s){},85:function(e,t,s){"use strict";s.r(t);var a=s(0),n=s(1),c=s.n(n),r=s(27),i=s.n(r),o=s(16),l=s(5),u=(s(61),s(2)),j="LOGIN_SUCCESS",d="LOGIN_FAIL",b="LOAD_USER_SUCCESS",p="LOAD_USER_FAIL",h="AUTHENTICATED_SUCCESS",m="AUTHENTICATED_FAIL",O="AUTHENTICATED_SUCCESS",f="AUTHENTICATED_FAIL",x="AUTHENTICATED_SUCCESS",g="AUTHENTICATED_FAIL",v="LOG_OUT",y="SIGNUP_SUCCESS",w="SIGNUP_FAIL",N="ACTIVATION_SUCCESS",k="ACTIVATION_FAIL",S={access:localStorage.getItem("access"),refresh:localStorage.getItem("refresh"),isAuthenticated:null,user:null};var C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0,s=t.type,a=t.payload;switch(s){case j:return localStorage.setItem("access",a.access),Object(u.a)(Object(u.a)({},e),{},{isAuthenticated:!0,access:a.access,refresh:a.refresh});case d:case w:case v:return localStorage.getItem("access")&&localStorage.removeItem("access"),Object(u.a)(Object(u.a)({},e),{},{access:null,refresh:null,isAuthenticated:!1,user:null});case b:return Object(u.a)(Object(u.a)({},e),{},{user:a.user});case p:return Object(u.a)(Object(u.a)({},e),{},{access:null,refresh:null,isAuthenticated:!1,user:null});case h:return Object(u.a)(Object(u.a)({},e),{},{user:a});case m:return Object(u.a)(Object(u.a)({},e),{},{user:null});case y:return Object(u.a)(Object(u.a)({},e),{},{isAuthenticated:!1});case O:case f:case x:case g:case k:case N:return Object(u.a)({},e);default:return e}},A=Object(o.combineReducers)({reducer:C}),_=s(6),T=s(4),I=s(9),E=s.n(I),M=s(18),R=s(19),L=s.n(R),D=function(){return function(){var e=Object(M.a)(E.a.mark((function e(t){var s,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("access")){e.next=15;break}return console.log("load_user::","JWT ".concat(localStorage.getItem("access"))),s={headers:{"Content-Type":"application/json",Authorization:"JWT ".concat(localStorage.getItem("access")),Accept:"application/json"}},e.prev=3,e.next=6,L.a.get("".concat("http://localhost:8000","/auth/users/me/"),s);case 6:a=e.sent,t({type:b,payload:a.data}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t({type:p});case 13:e.next=17;break;case 15:console.log("no access"),t({type:p});case 17:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()},U=function(){return function(){var e=Object(M.a)(E.a.mark((function e(t){var s,a,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!localStorage.getItem("access")){e.next=15;break}return s={headers:{"Content-Type":"application/json",Accept:"application/json"}},a=JSON.stringify({token:localStorage.getItem("access")}),e.prev=3,e.next=6,L.a.post("".concat("http://localhost:8000","/auth/jwt/verify/"),a,s);case 6:n=e.sent,t("token_not_valid"!==n?{type:h}:{type:m}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t({type:m});case 13:e.next=16;break;case 15:t({type:m});case 16:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()};function F(e){e.isTrusted}var P=function(){return Object(a.jsx)("div",{className:"container",children:Object(a.jsxs)("div",{class:"jumbotron mt-5",children:[Object(a.jsx)("h1",{class:"display-4",children:"Welcome"}),Object(a.jsx)("p",{class:"lead",children:"This is authentication system."}),Object(a.jsx)("hr",{class:"my-4"}),Object(a.jsx)("p",{children:"Click the login button"}),Object(a.jsx)(_.b,{class:"btn btn-primary btn-lg",to:"/login",role:"button",onClick:F,children:"Login"})]})})},J=s(13),H=s(7),q=Object(l.b)((function(e){return{isAuthenticated:e.reducer.isAuthenticated}}),(function(e){return{login:function(t,s){return e(function(e,t){return function(){var s=Object(M.a)(E.a.mark((function s(a){var n,c,r;return E.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return n={headers:{"Content-Type":"application/json"}},c=JSON.stringify({email:e,password:t}),s.prev=2,s.next=5,L.a.post("".concat("http://localhost:8000","/auth/jwt/create/"),c,n);case 5:r=s.sent,a({type:j,payload:r.data}),a(D()),s.next=13;break;case 10:s.prev=10,s.t0=s.catch(2),a({type:d});case 13:case"end":return s.stop()}}),s,null,[[2,10]])})));return function(e){return s.apply(this,arguments)}}()}(t,s))}}}))((function(e){var t=Object(n.useState)({email:"",password:""}),s=Object(H.a)(t,2),c=s[0],r=s[1],i=c.email,o=c.password,l=function(e){return r(Object(u.a)(Object(u.a)({},c),{},Object(J.a)({},e.target.name,e.target.value)))};return e.isAuthenticated?Object(a.jsx)(T.a,{to:"/:chatID/"}):Object(a.jsxs)("div",{className:"eontainer mt-5",children:[Object(a.jsx)("h1",{children:"Sign in"}),Object(a.jsx)("p1",{children:"Sign into your Account"}),Object(a.jsxs)("form",{onSubmit:function(t){return function(t){t.preventDefault(),e.login(i,o)}(t)},children:[Object(a.jsx)("div",{className:"form-group",children:Object(a.jsx)("input",{className:"from-control",type:"email",placeholder:"Email",name:"email",value:i,onChange:function(e){return l(e)},required:!0})}),Object(a.jsx)("div",{className:"form-group",children:Object(a.jsx)("input",{className:"from-control",type:"password",placeholder:"Password",name:"password",value:o,onChange:function(e){return l(e)},required:!0})}),Object(a.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Login"})]}),Object(a.jsxs)("p",{className:"mt-3",children:["Don't have an account? ",Object(a.jsx)(_.b,{to:"/signup",children:"Sign up"})]}),Object(a.jsxs)("p",{className:"mt-3",children:["Forget your password? ",Object(a.jsx)(_.b,{to:"/reset_password",children:"Reset Password"})]})]})})),W=Object(l.b)((function(e){return{isAuthenticated:e.reducer.isAuthenticated}}),(function(e){return{signup:function(t,s,a,n){return e(function(e,t,s,a){return function(){var n=Object(M.a)(E.a.mark((function n(c){var r,i,o;return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={headers:{"Content-Type":"application/json"}},i=JSON.stringify({name:e,email:t,password:s,re_password:a}),n.prev=2,n.next=5,L.a.post("".concat("http://localhost:8000","/auth/users/"),i,r);case 5:o=n.sent,c({type:y,payload:o.data}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(2),c({type:w});case 12:case"end":return n.stop()}}),n,null,[[2,9]])})));return function(e){return n.apply(this,arguments)}}()}(t,s,a,n))}}}))((function(e){var t=Object(n.useState)(!1),s=Object(H.a)(t,2),c=s[0],r=s[1],i=Object(n.useState)({name:"",email:"",password:"",re_password:""}),o=Object(H.a)(i,2),l=o[0],j=o[1],d=l.name,b=l.email,p=l.password,h=l.re_password,m=function(e){return j(Object(u.a)(Object(u.a)({},l),{},Object(J.a)({},e.target.name,e.target.value)))};return e.isAuthenticated||c?Object(a.jsx)(T.a,{to:"/"}):Object(a.jsxs)("div",{className:"eontainer mt-5",children:[Object(a.jsx)("h1",{children:"Sign up"}),Object(a.jsx)("p1",{children:"Create your Account"}),Object(a.jsxs)("form",{onSubmit:function(t){return function(t){t.preventDefault(),console.log(d,b,p,h),e.signup(d,b,p,h),r(!0)}(t)},children:[Object(a.jsx)("div",{className:"form-group",children:Object(a.jsx)("input",{className:"from-control",type:"name",placeholder:"name",name:"name",value:d,onChange:function(e){return m(e)},required:!0})}),Object(a.jsx)("div",{className:"form-group",children:Object(a.jsx)("input",{className:"from-control",type:"email",placeholder:"Email*",name:"email",value:b,onChange:function(e){return m(e)},required:!0})}),Object(a.jsx)("div",{className:"form-group",children:Object(a.jsx)("input",{className:"from-control",type:"password",placeholder:"Password*",name:"password",value:p,onChange:function(e){return m(e)},required:!0})}),Object(a.jsx)("div",{className:"form-group",children:Object(a.jsx)("input",{className:"from-control",type:"password",placeholder:"Confirm Password*",name:"re_password",value:h,onChange:function(e){return m(e)},required:!0})}),Object(a.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Sign up"})]}),Object(a.jsxs)("p",{className:"mt-3",children:["Already have an account? ",Object(a.jsx)(_.b,{to:"/login",children:"Log in"})]})]})})),G=Object(l.b)((function(e,t){return{isAuthenticated:e.reducer.isAuthenticated,uid:t.match.params.uid,token:t.match.params.token}}),(function(e){return{verify:function(t,s){return e(function(e,t){return function(){var s=Object(M.a)(E.a.mark((function s(a){var n,c,r;return E.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return n={headers:{"Content-Type":"application/json"}},c=JSON.stringify({uid:e,token:t}),s.prev=2,s.next=5,L.a.post("".concat("http://localhost:8000","/auth/users/activation/"),c,n);case 5:r=s.sent,a({type:N,payload:r.data}),s.next=12;break;case 9:s.prev=9,s.t0=s.catch(2),a({type:k});case 12:case"end":return s.stop()}}),s,null,[[2,9]])})));return function(e){return s.apply(this,arguments)}}()}(t,s))}}}))((function(e){var t=Object(n.useState)(!1),s=Object(H.a)(t,2),c=s[0],r=s[1];return c?Object(a.jsx)(T.a,{to:"/"}):Object(a.jsx)("div",{className:"eontainer mt-5",children:Object(a.jsxs)("div",{className:"d-flex flex-column justify-content-center align-items-center",style:{marginTop:"200px"},children:[Object(a.jsx)("h1",{children:"Verify your account:"}),Object(a.jsx)("button",{onClick:function(t){e.verify(e.uid,e.token),r(!0)},style:{marginTop:"50px"},type:"button",className:"btn btn-primary",children:"Verify"})]})})})),V=Object(l.b)(null,(function(e){return{reset_password:function(t){return e(function(e){return function(){var t=Object(M.a)(E.a.mark((function t(s){var a,n,c;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={headers:{"Content-Type":"application/json"}},n=JSON.stringify({email:e}),t.prev=2,t.next=5,L.a.post("".concat("http://localhost:8000","/auth/users/reset_password/"),n,a);case 5:c=t.sent,console.log("PASSWORD_RESET"),s({type:O,payload:c.data}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),s({type:f});case 13:case"end":return t.stop()}}),t,null,[[2,10]])})));return function(e){return t.apply(this,arguments)}}()}(t))}}}))((function(e){var t=Object(n.useState)(!1),s=Object(H.a)(t,2),c=s[0],r=s[1],i=Object(n.useState)({email:""}),o=Object(H.a)(i,2),l=o[0],j=o[1],d=l.email;return c?Object(a.jsx)(T.a,{to:"/"}):Object(a.jsxs)("div",{className:"eontainer mt-5",children:[Object(a.jsx)("h1",{children:"Request Password Reset"}),Object(a.jsxs)("form",{onSubmit:function(t){return function(t){t.preventDefault(),e.reset_password(d),r(!0)}(t)},children:[Object(a.jsx)("div",{className:"form-group",children:Object(a.jsx)("input",{className:"from-control",type:"email",placeholder:"Email",name:"email",value:d,onChange:function(e){return function(e){return j(Object(u.a)(Object(u.a)({},l),{},Object(J.a)({},e.target.name,e.target.value)))}(e)},required:!0})}),Object(a.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Reset Password"})]})]})})),B=Object(l.b)((function(e,t){return{uid:t.match.params.uid,token:t.match.params.token}}),(function(e){return{reset_password_confirm:function(t,s,a,n){return e(function(e,t,s,a){return function(){var n=Object(M.a)(E.a.mark((function n(c){var r,i;return E.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r={headers:{"Content-Type":"application/json"}},i=JSON.stringify({uid:e,token:t,new_password:s,re_new_password:a}),console.log("PASSWORD_RESET_CONFIRM"),n.prev=3,n.next=6,L.a.post("".concat("http://localhost:8000","/auth/users/reset_password_confirm/"),i,r);case 6:c({type:x}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(3),c({type:g});case 12:case"end":return n.stop()}}),n,null,[[3,9]])})));return function(e){return n.apply(this,arguments)}}()}(t,s,a,n))}}}))((function(e){var t=Object(n.useState)(!1),s=Object(H.a)(t,2),c=s[0],r=s[1],i=Object(n.useState)({new_password:"",re_new_password:""}),o=Object(H.a)(i,2),l=o[0],j=o[1];console.log("token::",e.token);var d=l.new_password,b=l.re_new_password,p=function(e){return j(Object(u.a)(Object(u.a)({},l),{},Object(J.a)({},e.target.name,e.target.value)))};return c?Object(a.jsx)(T.a,{to:"/"}):Object(a.jsxs)("div",{className:"eontainer mt-5",children:[Object(a.jsx)("h1",{children:"Request Password Reset"}),Object(a.jsxs)("form",{onSubmit:function(t){return function(t){t.preventDefault();var s=e.uid,a=e.token;e.reset_password_confirm(s,a,d,b),r(!0)}(t)},children:[Object(a.jsx)("div",{className:"form-group",children:Object(a.jsx)("input",{className:"from-control",type:"password",placeholder:"New Pasword",name:"new_password",value:d,onChange:function(e){return p(e)},required:!0})}),Object(a.jsx)("div",{className:"form-group",children:Object(a.jsx)("input",{className:"from-control",type:"password",placeholder:"Confirm New Password",name:"re_new_password",value:b,onChange:function(e){return p(e)},required:!0})}),Object(a.jsx)("button",{className:"btn btn-primary",type:"submit",children:"PasswordResetConfirm"})]})]})})),Y=Object(l.b)((function(e){return{isAuthenticated:e.reducer.isAuthenticated}}),(function(e){return{logout:function(){return e((function(e){e({type:v})}))}}}))((function(e){return Object(a.jsxs)("nav",{class:"navbar navbar-expand-lg navbar-light bg-light",children:[Object(a.jsx)(_.b,{class:"navbar-brand",to:"/",children:"Auth System"}),Object(a.jsx)("button",{class:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(a.jsx)("span",{class:"navbar-toggler-icon"})}),Object(a.jsx)("div",{class:"collapse navbar-collapse",id:"navbarNav",children:Object(a.jsxs)("ul",{class:"navbar-nav",children:[Object(a.jsx)("li",{class:"nav-item active",children:Object(a.jsxs)(_.b,{class:"nav-link",to:"/",children:["Home",Object(a.jsx)("span",{class:"sr-only",children:"(current)"})]})}),e.isAuthenticated?Object(a.jsx)("li",{class:"nav-item active",children:Object(a.jsxs)(_.b,{class:"nav-link",to:"/",onClick:e.logout,children:["Logout",Object(a.jsx)("span",{class:"sr-only",children:"(current)"})]})}):Object(a.jsxs)(n.Fragment,{children:[Object(a.jsx)("li",{class:"nav-item active",children:Object(a.jsx)(_.b,{class:"nav-link",to:"/login",children:"Login"})}),Object(a.jsx)("li",{class:"nav-item active",children:Object(a.jsx)(_.b,{class:"nav-link",to:"/signup",children:"Signup"})})]})]})})]})})),z=Object(l.b)(null,(function(e){return{checkAuthenticated:function(){return e(U())},load_user:function(){return e(D())}}}))((function(e){return Object(n.useEffect)((function(){e.checkAuthenticated(),e.load_user()}),[]),Object(a.jsxs)("div",{children:[Object(a.jsx)(Y,{}),e.children]})})),K=s(51),Q=s(17),X=s(15),Z=s(25),$=s(22),ee=s(21),te=s(87),se=(s(32),s(81),function(e){Object($.a)(s,e);var t=Object(ee.a)(s);function s(){var e;Object(Q.a)(this,s);for(var a=arguments.length,n=new Array(a),c=0;c<a;c++)n[c]=arguments[c];return(e=t.call.apply(t,[this].concat(n))).state={loginForm:!0},e}return Object(X.a)(s,[{key:"render",value:function(){return Object(a.jsxs)("div",{id:"sidepanel",children:[Object(a.jsx)("div",{id:"profile",children:Object(a.jsxs)("div",{className:"wrap",children:[Object(a.jsx)("img",{id:"profile-img",src:"http://emilcarlsson.se/assets/mikeross.png",className:"online",alt:""}),Object(a.jsx)("p",{children:"Mike Ross"}),Object(a.jsx)("i",{className:"fa fa-chevron-down expand-button","aria-hidden":"true"}),Object(a.jsx)("div",{id:"status-options",children:Object(a.jsxs)("ul",{children:[Object(a.jsxs)("li",{id:"status-online",className:"active",children:[Object(a.jsx)("span",{className:"status-circle"})," ",Object(a.jsx)("p",{children:"Online"})]}),Object(a.jsxs)("li",{id:"status-away",children:[Object(a.jsx)("span",{className:"status-circle"})," ",Object(a.jsx)("p",{children:"Away"})]}),Object(a.jsxs)("li",{id:"status-busy",children:[Object(a.jsx)("span",{className:"status-circle"})," ",Object(a.jsx)("p",{children:"Busy"})]}),Object(a.jsxs)("li",{id:"status-offline",children:[Object(a.jsx)("span",{className:"status-circle"})," ",Object(a.jsx)("p",{children:"Offline"})]})]})}),Object(a.jsx)("div",{id:"expanded",children:this.props.loading?Object(a.jsx)(te.a,{}):this.props.isAuthenticated?Object(a.jsx)("button",{className:"authBtn",children:Object(a.jsx)("span",{children:"Logout"})}):Object(a.jsxs)("div",{children:[Object(a.jsxs)("form",{method:"POST",onSubmit:this.authenticate,children:[this.state.loginForm?Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{name:"username",type:"text",placeholder:"username"}),Object(a.jsx)("input",{name:"password",type:"password",placeholder:"password"})]}):Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{name:"username",type:"text",placeholder:"username"}),Object(a.jsx)("input",{name:"email",type:"email",placeholder:"email"}),Object(a.jsx)("input",{name:"password",type:"password",placeholder:"password"}),Object(a.jsx)("input",{name:"password2",type:"password",placeholder:"password confirm"})]}),Object(a.jsx)("button",{type:"submit",children:"Authenticate"})]}),Object(a.jsx)("button",{children:"Switch"})]})})]})}),Object(a.jsxs)("div",{id:"search",children:[Object(a.jsx)("label",{htmlFor:"",children:Object(a.jsx)("i",{className:"fa fa-search","aria-hidden":"true"})}),Object(a.jsx)("input",{type:"text",placeholder:"Search contacts..."})]}),Object(a.jsx)("div",{id:"contacts",children:Object(a.jsxs)("ul",{children:[Object(a.jsx)("li",{className:"contact",children:Object(a.jsxs)("div",{className:"wrap",children:[Object(a.jsx)("span",{className:"contact-status online"}),Object(a.jsx)("img",{src:"http://emilcarlsson.se/assets/louislitt.png",alt:""}),Object(a.jsxs)("div",{className:"meta",children:[Object(a.jsx)("p",{className:"name",children:"Louis Litt"}),Object(a.jsx)("p",{className:"preview",children:"You just got LITT up, Mike."})]})]})}),Object(a.jsx)("li",{className:"contact active",children:Object(a.jsxs)("div",{className:"wrap",children:[Object(a.jsx)("span",{className:"contact-status busy"}),Object(a.jsx)("img",{src:"http://emilcarlsson.se/assets/harveyspecter.png",alt:""}),Object(a.jsxs)("div",{className:"meta",children:[Object(a.jsx)("p",{className:"name",children:"Harvey Specter"}),Object(a.jsx)("p",{className:"preview",children:"Wrong. You take the gun, or you pull out a bigger one. Or, you call their bluff. Or, you do any one of a hundred and htmlForty six other things."})]})]})})]})}),Object(a.jsxs)("div",{id:"bottom-bar",children:[Object(a.jsxs)("button",{id:"addcontact",children:[Object(a.jsx)("i",{className:"fa fa-user-plus fa-fw","aria-hidden":"true"})," ",Object(a.jsx)("span",{children:"Add contact"})]}),Object(a.jsxs)("button",{id:"settings",children:[Object(a.jsx)("i",{className:"fa fa-cog fa-fw","aria-hidden":"true"})," ",Object(a.jsx)("span",{children:"Settings"})]})]})]})}}]),s}(c.a.Component)),ae=(s(84),function(e){Object($.a)(s,e);var t=Object(ee.a)(s);function s(){return Object(Q.a)(this,s),t.apply(this,arguments)}return Object(X.a)(s,[{key:"render",value:function(){return Object(a.jsx)("div",{className:"contact-profile",children:Object(a.jsxs)(z,{children:[Object(a.jsx)("img",{src:"http://emilcarlsson.se/assets/harveyspecter.png",alt:""}),Object(a.jsx)("p",{children:this.props.username}),Object(a.jsxs)("div",{className:"social-media",children:[Object(a.jsx)("i",{className:"fa fa-facebook","aria-hidden":"true"}),Object(a.jsx)("i",{className:"fa fa-twitter","aria-hidden":"true"}),Object(a.jsx)("i",{className:"fa fa-instagram","aria-hidden":"true"})]})]})})}}]),s}(c.a.Component)),ne=function(){function e(){Object(Q.a)(this,e),this.callbacks={},this.socketRef=null}return Object(X.a)(e,null,[{key:"getInstance",value:function(){return e.instace||(e.instance=new e),e.instance}}]),Object(X.a)(e,[{key:"connect",value:function(){var e=this;this.socketRef=new WebSocket("ws://127.0.0.1:8000/ws/chat/test/"),this.socketRef.onopen=function(){console.log("open")},this.socketNewMessage(JSON.stringify({command:"messages"})),this.socketRef.onmessage=function(t){e.socketNewMessage(t.data)},this.socketRef.onclose=function(){console.log("close"),e.connect()},this.socketRef.onerror=function(e){console.log(e.message)}}},{key:"socketNewMessage",value:function(e){var t=JSON.parse(e),s=t.command;console.log("parseData::",t),0!==Object.keys(this.callbacks).length&&("messages"===s&&this.callbacks[s](t.messages),"new_message"===s&&this.callbacks[s](t.message))}},{key:"fetchMessages",value:function(e){this.sendMessage({command:"fetch_messages",username:e})}},{key:"newChatMessage",value:function(e){console.log("newChatMessage::",e),this.sendMessage({command:"new_message",from:e.from,message:e.content})}},{key:"addCallbacks",value:function(e,t){this.callbacks.messages=e,this.callbacks.new_message=t}},{key:"sendMessage",value:function(e){console.log("data in sendMessage",e);try{this.socketRef.send(JSON.stringify(Object(u.a)({},e)))}catch(t){console.log(t.message)}}},{key:"state",value:function(){return this.socketRef.readyState}}]),e}();ne.instance=null;var ce=ne.getInstance();ce.connect();var re=function(e){Object($.a)(s,e);var t=Object(ee.a)(s);function s(e){var n;return Object(Q.a)(this,s),(n=t.call(this,e)).renderMessages=function(e){return e.map((function(e){return Object(a.jsxs)("li",{className:"kikuchi"===e.author?"sent":"replies",children:[Object(a.jsx)("img",{src:"http://emilcarlsson.se/assets/mikeross.png"}),Object(a.jsxs)("p",{children:[e.content,Object(a.jsx)("br",{}),Object(a.jsx)("small",{children:e.timestamp.substring(0,16)})]})]},e.id)}))},n.messageChangeHandler=function(e){n.setState({message:e.target.value})},n.sendMessageHandler=function(e){e.preventDefault();var t={from:"kikuchi",content:n.state.message};t.content&&(console.log(t.content),ce.newChatMessage(t),n.setState({message:""}))},n.state={messages:[],message:""},n.waitForSocketConnection((function(){ce.addCallbacks(n.setMessage.bind(Object(Z.a)(n)),n.addMessage.bind(Object(Z.a)(n))),ce.fetchMessages("daisuke")})),n}return Object(X.a)(s,[{key:"waitForSocketConnection",value:function(e){var t=this;setTimeout((function(){if(1===ce.state())return console.log("connection is secure"),void e();console.log("waiting for connection ...."),t.waitForSocketConnection(e)}),100)}},{key:"setMessage",value:function(e){this.setState({messages:e.reverse()})}},{key:"addMessage",value:function(e){this.setState({messages:[].concat(Object(K.a)(this.state.messages),[e[0]])})}},{key:"render",value:function(){var e=this.state.messages;return Object(a.jsx)("div",{id:"frame",children:Object(a.jsxs)("div",{className:"content",children:[Object(a.jsx)(ae,{}),Object(a.jsx)(se,{}),Object(a.jsx)("div",{className:"messages",children:Object(a.jsx)("ul",{id:"chat-log",children:e&&this.renderMessages(e)})}),Object(a.jsx)("div",{className:"message-input",children:Object(a.jsx)("form",{onSubmit:this.sendMessageHandler,children:Object(a.jsxs)("div",{className:"wrap",children:[Object(a.jsx)("input",{onChange:this.messageChangeHandler,value:this.state.message,id:"chat-message-input",type:"text",placeholder:"Write your message..."}),Object(a.jsx)("i",{className:"fa fa-paperclip attachment","aria-hidden":"true"}),Object(a.jsx)("button",{id:"chat-message-submit",className:"submit",children:Object(a.jsx)("i",{className:"fa fa-paper-plane","aria-hidden":"true"})})]})})})]})})}}]),s}(c.a.Component),ie=Object(l.b)(null,(function(e){return{checkAuthenticated:function(){return e(U)}}}))((function(e){return Object(n.useEffect)((function(){e.checkAuthenticated()})),Object(a.jsxs)(_.a,{children:[Object(a.jsx)(z,{children:Object(a.jsxs)(T.d,{children:[Object(a.jsx)(T.b,{exact:!0,path:"/",component:P}),Object(a.jsx)(T.b,{exact:!0,path:"/login",component:q}),Object(a.jsx)(T.b,{exact:!0,path:"/signup",component:W}),Object(a.jsx)(T.b,{exact:!0,path:"/reset_password",component:V}),Object(a.jsx)(T.b,{exact:!0,path:"/password/reset/confirm/:uid/:token",component:B}),Object(a.jsx)(T.b,{exact:!0,path:"/activate/:uid/:token",component:G})]})}),Object(a.jsx)(T.d,{children:Object(a.jsx)(T.b,{exact:!0,path:"/:chatID/",component:re})})]})})),oe=s(49),le=[s(50).a],ue=Object(o.createStore)(A,{},Object(oe.composeWithDevTools)(o.applyMiddleware.apply(void 0,le))),je=Object(a.jsx)(l.a,{store:ue,children:Object(a.jsx)(ie,{})});i.a.render(je,document.getElementById("app"))}},[[85,1,2]]]);
//# sourceMappingURL=main.76572892.chunk.js.map